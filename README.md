Based on the ThinkDSP book, but with more elegant code(?)
